10 REM === SedaiBasic Sprite Test Suite ===
20 REM Run with sbv.exe (requires SDL2 graphics)

100 SCNCLR
110 PRINT "=== SPRITE TEST SUITE ==="
120 PRINT
130 TP% = 0 : TF% = 0

200 REM TEST 1: Enable/Disable
210 SPRITE 1, 1, 2
220 E1 = RSPRITE(1, 0)
230 TN$ = "Enable on": EX = 1: AC = E1: GOSUB 9500
240 SPRITE 1, 0, 2
250 E2 = RSPRITE(1, 0)
260 TN$ = "Enable off": EX = 0: AC = E2: GOSUB 9500

300 REM TEST 2: Color
310 SPRITE 1, 1, 5
320 TN$ = "Color=5": EX = 5: AC = RSPRITE(1, 1): GOSUB 9500
330 SPRITE 2, 1, 7
340 TN$ = "Color=7": EX = 7: AC = RSPRITE(2, 1): GOSUB 9500

400 REM TEST 3: Priority
410 SPRITE 1, 1, 2, 0
420 TN$ = "Priority=0": EX = 0: AC = RSPRITE(1, 2): GOSUB 9500
430 SPRITE 1, 1, 2, 3
440 TN$ = "Priority=3": EX = 3: AC = RSPRITE(1, 2): GOSUB 9500

500 REM TEST 4: Scale
510 SPRITE 1, 1, 2, 0, 2, 2
520 SX = RSPRITE(1, 3): SY = RSPRITE(1, 4)
530 IF SX >= 1.9 AND SX <= 2.1 THEN TP% = TP% + 1: PRINT "  [PASS] ScaleX=2"
540 IF SX < 1.9 OR SX > 2.1 THEN TF% = TF% + 1: PRINT "  [FAIL] ScaleX exp=2 got "; SX
550 IF SY >= 1.9 AND SY <= 2.1 THEN TP% = TP% + 1: PRINT "  [PASS] ScaleY=2"
560 IF SY < 1.9 OR SY > 2.1 THEN TF% = TF% + 1: PRINT "  [FAIL] ScaleY exp=2 got "; SY
570 SPRITE 1, 1, 2, 0, 1, 1

600 REM TEST 5: MOVSPR Absolute
610 SPRITE 1, 1, 2
620 MOVSPR 1, 100, 80
630 TN$ = "AbsX=100": EX = 100: AC = RSPPOS(1, 0): GOSUB 9500
640 TN$ = "AbsY=80": EX = 80: AC = RSPPOS(1, 1): GOSUB 9500

700 REM TEST 6: MOVSPR Relative
710 MOVSPR 1, 100, 80
720 MOVSPR 1, +20, +10
730 TN$ = "RelX=120": EX = 120: AC = RSPPOS(1, 0): GOSUB 9500
740 TN$ = "RelY=90": EX = 90: AC = RSPPOS(1, 1): GOSUB 9500

800 REM TEST 7: SPRCOLOR
810 SPRCOLOR 1, 2
820 TN$ = "MC1=1": EX = 1: AC = RSPCOLOR(1): GOSUB 9500
830 TN$ = "MC2=2": EX = 2: AC = RSPCOLOR(2): GOSUB 9500

900 REM TEST 8: Multiple sprites
910 SPRITE 1, 1, 2: SPRITE 2, 1, 5: SPRITE 3, 1, 7: SPRITE 4, 1, 3
920 E = 0
930 IF RSPRITE(1, 0) = 1 THEN E = E + 1
940 IF RSPRITE(2, 0) = 1 THEN E = E + 1
950 IF RSPRITE(3, 0) = 1 THEN E = E + 1
960 IF RSPRITE(4, 0) = 1 THEN E = E + 1
970 TN$ = "4 enabled": EX = 4: AC = E: GOSUB 9500

1000 REM TEST 9: BUMP
1010 SS = BUMP(1): SB = BUMP(2)
1020 TP% = TP% + 1: PRINT "  [PASS] BUMP (no crash)"

1100 REM TEST 10: SPRSAV
1110 SPRSAV 1, SP1$
1120 IF LEN(SP1$) > 0 THEN TP% = TP% + 1: PRINT "  [PASS] SPRSAV len="; LEN(SP1$)
1130 IF LEN(SP1$) = 0 THEN TF% = TF% + 1: PRINT "  [FAIL] SPRSAV empty"
1140 SPRSAV SP1$, 5

2000 REM === RESULTS ===
2010 PRINT
2020 PRINT "Passed: "; TP%; " / Failed: "; TF%; " / Total: "; TP% + TF%
2030 IF TF% = 0 THEN PRINT "ALL TESTS PASSED!"
2040 IF TF% > 0 THEN PRINT "SOME TESTS FAILED"
2050 PRINT
2060 GOTO 3000

3000 REM === VISUAL DEMO: VORTEX ===
3010 PRINT "--- Vortex Demo (press any key to exit) ---"
3020 REM Disable all sprites first
3030 SPRITE 1, 0: SPRITE 2, 0: SPRITE 3, 0: SPRITE 4, 0: SPRITE 5, 0
3040 REM 4 sprites from center (640x400 viewport)
3050 SPRITE 1, 1, 2, 0, 3, 3
3060 SPRITE 2, 1, 5, 0, 3, 3
3070 SPRITE 3, 1, 7, 0, 3, 3
3080 SPRITE 4, 1, 3, 0, 3, 3
3090 REM Auto-move spiral: SQR(T) gives decreasing angular velocity = spiral
3100 MOVSPR 1, 283, 168: MOVSPR 2, 283, 168: MOVSPR 3, 283, 168: MOVSPR 4, 283, 168
3110 T0 = TI
3120 MOVSPR 1, 315 #3: MOVSPR 2, 45 #3: MOVSPR 3, 225 #3: MOVSPR 4, 135 #3
3130 GET A$: IF A$ <> "" THEN GOTO 3250
3140 T = TI - T0
3150 A = SQR(T) * 20
3160 MOVSPR 1, 315 + A #3
3170 MOVSPR 2, 45 + A #3
3180 MOVSPR 3, 225 + A #3
3190 MOVSPR 4, 135 + A #3
3200 IF T < 300 THEN GOTO 3130
3210 GOTO 3100
3250 REM Clean up
3260 SPRITE 1, 0: SPRITE 2, 0: SPRITE 3, 0: SPRITE 4, 0
3270 PRINT "Done."
3280 END

9500 REM *** Assert ***
9510 IF EX = AC THEN GOTO 9560
9520 PRINT "  [FAIL] "; TN$; " exp="; EX; " got="; AC
9530 TF% = TF% + 1
9540 RETURN
9560 PRINT "  [PASS] "; TN$
9570 TP% = TP% + 1
9580 RETURN
