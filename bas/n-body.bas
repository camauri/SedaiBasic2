1 REM THE COMPUTER LANGUAGE BENCHMARKS GAME
2 REM N-BODY SIMULATION
3 REM CONVERTED FROM PYTHON TO TINY BASIC
4 REM =====================================
5 REM
10 REM CONSTANTS
20 PI = 3.14159265358979323
30 SOLAR_MASS = 4 * PI * PI
40 DAYS_PER_YEAR = 365.24
50 REM
100 REM BODIES DATA - SUN
110 SX = 0: SY = 0: SZ = 0
120 SVX = 0: SVY = 0: SVZ = 0
130 SM = SOLAR_MASS
140 REM
200 REM BODIES DATA - JUPITER
210 JX = 4.84143144246472090
220 JY = -1.16032004402742839
230 JZ = -0.103622044471123109
240 JVX = 0.00166007664274403694 * DAYS_PER_YEAR
250 JVY = 0.00769901118419740425 * DAYS_PER_YEAR
260 JVZ = -0.0000690460016972063023 * DAYS_PER_YEAR
270 JM = 0.000954791938424326609 * SOLAR_MASS
280 REM
300 REM BODIES DATA - SATURN
310 SAX = 8.34336671824457987
320 SAY = 4.12479856412430479
330 SAZ = -0.403523417114321381
340 SAVX = -0.00276742510726862411 * DAYS_PER_YEAR
350 SAVY = 0.00499852801234917238 * DAYS_PER_YEAR
360 SAVZ = 0.0000230417297573763929 * DAYS_PER_YEAR
370 SAM = 0.000285885980666130812 * SOLAR_MASS
380 REM
400 REM BODIES DATA - URANUS
410 UX = 12.8943695621391310
420 UY = -15.1111514016986312
430 UZ = -0.223307578892655734
440 UVX = 0.00296460137564761618 * DAYS_PER_YEAR
450 UVY = 0.00237847173959480950 * DAYS_PER_YEAR
460 UVZ = -0.0000296589568540237556 * DAYS_PER_YEAR
470 UM = 0.0000436624404335156298 * SOLAR_MASS
480 REM
500 REM BODIES DATA - NEPTUNE
510 NX = 15.3796971148509165
520 NY = -25.9193146099879641
530 NZ = 0.179258772950371181
540 NVX = 0.00268067772490389322 * DAYS_PER_YEAR
550 NVY = 0.00162824170038242295 * DAYS_PER_YEAR
560 NVZ = -0.0000951592254519715870 * DAYS_PER_YEAR
570 NM = 0.0000515138902046611451 * SOLAR_MASS
580 REM
1000 REM MAIN PROGRAM
1010 rem PRINT "THE COMPUTER LANGUAGE BENCHMARKS GAME"
1020 rem PRINT "N-BODY SIMULATION (GOSUB)"
1030 rem PRINT
1040 N%=1000
1050 rem PRINT "ITERATIONS: "; N%
1060 REM
1070 REM OFFSET MOMENTUM (CENTER ON SUN)
1080 PX = 0: PY = 0: PZ = 0
1090 PX = PX - JVX * JM
1100 PY = PY - JVY * JM
1110 PZ = PZ - JVZ * JM
1120 PX = PX - SAVX * SAM
1130 PY = PY - SAVY * SAM
1140 PZ = PZ - SAVZ * SAM
1150 PX = PX - UVX * UM
1160 PY = PY - UVY * UM
1170 PZ = PZ - UVZ * UM
1180 PX = PX - NVX * NM
1190 PY = PY - NVY * NM
1200 PZ = PZ - NVZ * NM
1210 SVX = PX / SM
1220 SVY = PY / SM
1230 SVZ = PZ / SM
1240 REM
1250 REM INITIAL ENERGY
1260 GOSUB 5000
1270 rem PRINT "INITIAL ENERGY: "; E
1275 PRINT E
1280 REM
1300 REM ADVANCE SIMULATION
1310 DT = 0.01
1320 FOR I% = 1 TO N%
1330 GOSUB 6000
1340 NEXT I%
1350 REM
1360 REM FINAL ENERGY
1370 GOSUB 5000
1380 rem PRINT "FINAL ENERGY:   "; E
1390 PRINT E
1400 END
1410 REM
5000 REM SUBROUTINE: CALCULATE ENERGY
5010 E = 0
5020 REM KINETIC ENERGY
5030 E = E + SM * (SVX * SVX + SVY * SVY + SVZ * SVZ) / 2
5040 E = E + JM * (JVX * JVX + JVY * JVY + JVZ * JVZ) / 2
5050 E = E + SAM * (SAVX * SAVX + SAVY * SAVY + SAVZ * SAVZ) / 2
5060 E = E + UM * (UVX * UVX + UVY * UVY + UVZ * UVZ) / 2
5070 E = E + NM * (NVX * NVX + NVY * NVY + NVZ * NVZ) / 2
5080 REM POTENTIAL ENERGY - SUN-JUPITER
5090 DX = SX - JX: DY = SY - JY: DZ = SZ - JZ
5100 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5110 E = E - (SM * JM) / DIST
5120 REM SUN-SATURN
5130 DX = SX - SAX: DY = SY - SAY: DZ = SZ - SAZ
5140 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5150 E = E - (SM * SAM) / DIST
5160 REM SUN-URANUS
5170 DX = SX - UX: DY = SY - UY: DZ = SZ - UZ
5180 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5190 E = E - (SM * UM) / DIST
5200 REM SUN-NEPTUNE
5210 DX = SX - NX: DY = SY - NY: DZ = SZ - NZ
5220 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5230 E = E - (SM * NM) / DIST
5240 REM JUPITER-SATURN
5250 DX = JX - SAX: DY = JY - SAY: DZ = JZ - SAZ
5260 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5270 E = E - (JM * SAM) / DIST
5280 REM JUPITER-URANUS
5290 DX = JX - UX: DY = JY - UY: DZ = JZ - UZ
5300 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5310 E = E - (JM * UM) / DIST
5320 REM JUPITER-NEPTUNE
5330 DX = JX - NX: DY = JY - NY: DZ = JZ - NZ
5340 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5350 E = E - (JM * NM) / DIST
5360 REM SATURN-URANUS
5370 DX = SAX - UX: DY = SAY - UY: DZ = SAZ - UZ
5380 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5390 E = E - (SAM * UM) / DIST
5400 REM SATURN-NEPTUNE
5410 DX = SAX - NX: DY = SAY - NY: DZ = SAZ - NZ
5420 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5430 E = E - (SAM * NM) / DIST
5440 REM URANUS-NEPTUNE
5450 DX = UX - NX: DY = UY - NY: DZ = UZ - NZ
5460 DIST = SQR(DX * DX + DY * DY + DZ * DZ)
5470 E = E - (UM * NM) / DIST
5480 RETURN
5490 REM
6000 REM SUBROUTINE: ADVANCE (ONE TIMESTEP)
6010 REM UPDATE VELOCITIES - SUN-JUPITER
6020 DX = SX - JX: DY = SY - JY: DZ = SZ - JZ
6030 D2 = DX * DX + DY * DY + DZ * DZ
6040 DIST = SQR(D2)
6050 MAG = DT / (D2 * DIST)
6060 SVX = SVX - DX * JM * MAG
6070 SVY = SVY - DY * JM * MAG
6080 SVZ = SVZ - DZ * JM * MAG
6090 JVX = JVX + DX * SM * MAG
6100 JVY = JVY + DY * SM * MAG
6110 JVZ = JVZ + DZ * SM * MAG
6120 REM SUN-SATURN
6130 DX = SX - SAX: DY = SY - SAY: DZ = SZ - SAZ
6140 D2 = DX * DX + DY * DY + DZ * DZ
6150 DIST = SQR(D2)
6160 MAG = DT / (D2 * DIST)
6170 SVX = SVX - DX * SAM * MAG
6180 SVY = SVY - DY * SAM * MAG
6190 SVZ = SVZ - DZ * SAM * MAG
6200 SAVX = SAVX + DX * SM * MAG
6210 SAVY = SAVY + DY * SM * MAG
6220 SAVZ = SAVZ + DZ * SM * MAG
6230 REM SUN-URANUS
6240 DX = SX - UX: DY = SY - UY: DZ = SZ - UZ
6250 D2 = DX * DX + DY * DY + DZ * DZ
6260 DIST = SQR(D2)
6270 MAG = DT / (D2 * DIST)
6280 SVX = SVX - DX * UM * MAG
6290 SVY = SVY - DY * UM * MAG
6300 SVZ = SVZ - DZ * UM * MAG
6310 UVX = UVX + DX * SM * MAG
6320 UVY = UVY + DY * SM * MAG
6330 UVZ = UVZ + DZ * SM * MAG
6340 REM SUN-NEPTUNE
6350 DX = SX - NX: DY = SY - NY: DZ = SZ - NZ
6360 D2 = DX * DX + DY * DY + DZ * DZ
6370 DIST = SQR(D2)
6380 MAG = DT / (D2 * DIST)
6390 SVX = SVX - DX * NM * MAG
6400 SVY = SVY - DY * NM * MAG
6410 SVZ = SVZ - DZ * NM * MAG
6420 NVX = NVX + DX * SM * MAG
6430 NVY = NVY + DY * SM * MAG
6440 NVZ = NVZ + DZ * SM * MAG
6450 REM JUPITER-SATURN
6460 DX = JX - SAX: DY = JY - SAY: DZ = JZ - SAZ
6470 D2 = DX * DX + DY * DY + DZ * DZ
6480 DIST = SQR(D2)
6490 MAG = DT / (D2 * DIST)
6500 JVX = JVX - DX * SAM * MAG
6510 JVY = JVY - DY * SAM * MAG
6520 JVZ = JVZ - DZ * SAM * MAG
6530 SAVX = SAVX + DX * JM * MAG
6540 SAVY = SAVY + DY * JM * MAG
6550 SAVZ = SAVZ + DZ * JM * MAG
6560 REM JUPITER-URANUS
6570 DX = JX - UX: DY = JY - UY: DZ = JZ - UZ
6580 D2 = DX * DX + DY * DY + DZ * DZ
6590 DIST = SQR(D2)
6600 MAG = DT / (D2 * DIST)
6610 JVX = JVX - DX * UM * MAG
6620 JVY = JVY - DY * UM * MAG
6630 JVZ = JVZ - DZ * UM * MAG
6640 UVX = UVX + DX * JM * MAG
6650 UVY = UVY + DY * JM * MAG
6660 UVZ = UVZ + DZ * JM * MAG
6670 REM JUPITER-NEPTUNE
6680 DX = JX - NX: DY = JY - NY: DZ = JZ - NZ
6690 D2 = DX * DX + DY * DY + DZ * DZ
6700 DIST = SQR(D2)
6710 MAG = DT / (D2 * DIST)
6720 JVX = JVX - DX * NM * MAG
6730 JVY = JVY - DY * NM * MAG
6740 JVZ = JVZ - DZ * NM * MAG
6750 NVX = NVX + DX * JM * MAG
6760 NVY = NVY + DY * JM * MAG
6770 NVZ = NVZ + DZ * JM * MAG
6780 REM SATURN-URANUS
6790 DX = SAX - UX: DY = SAY - UY: DZ = SAZ - UZ
6800 D2 = DX * DX + DY * DY + DZ * DZ
6810 DIST = SQR(D2)
6820 MAG = DT / (D2 * DIST)
6830 SAVX = SAVX - DX * UM * MAG
6840 SAVY = SAVY - DY * UM * MAG
6850 SAVZ = SAVZ - DZ * UM * MAG
6860 UVX = UVX + DX * SAM * MAG
6870 UVY = UVY + DY * SAM * MAG
6880 UVZ = UVZ + DZ * SAM * MAG
6890 REM SATURN-NEPTUNE
6900 DX = SAX - NX: DY = SAY - NY: DZ = SAZ - NZ
6910 D2 = DX * DX + DY * DY + DZ * DZ
6920 DIST = SQR(D2)
6930 MAG = DT / (D2 * DIST)
6940 SAVX = SAVX - DX * NM * MAG
6950 SAVY = SAVY - DY * NM * MAG
6960 SAVZ = SAVZ - DZ * NM * MAG
6970 NVX = NVX + DX * SAM * MAG
6980 NVY = NVY + DY * SAM * MAG
6990 NVZ = NVZ + DZ * SAM * MAG
7000 REM URANUS-NEPTUNE
7010 DX = UX - NX: DY = UY - NY: DZ = UZ - NZ
7020 D2 = DX * DX + DY * DY + DZ * DZ
7030 DIST = SQR(D2)
7040 MAG = DT / (D2 * DIST)
7050 UVX = UVX - DX * NM * MAG
7060 UVY = UVY - DY * NM * MAG
7070 UVZ = UVZ - DZ * NM * MAG
7080 NVX = NVX + DX * UM * MAG
7090 NVY = NVY + DY * UM * MAG
7100 NVZ = NVZ + DZ * UM * MAG
7110 REM UPDATE POSITIONS
7120 SX = SX + DT * SVX
7130 SY = SY + DT * SVY
7140 SZ = SZ + DT * SVZ
7150 JX = JX + DT * JVX
7160 JY = JY + DT * JVY
7170 JZ = JZ + DT * JVZ
7180 SAX = SAX + DT * SAVX
7190 SAY = SAY + DT * SAVY
7200 SAZ = SAZ + DT * SAVZ
7210 UX = UX + DT * UVX
7220 UY = UY + DT * UVY
7230 UZ = UZ + DT * UVZ
7240 NX = NX + DT * NVX
7250 NY = NY + DT * NVY
7260 NZ = NZ + DT * NVZ
7270 RETURN
