1 REM THE COMPUTER LANGUAGE BENCHMARKS GAME
2 REM SPECTRAL-NORM BENCHMARK
3 REM CONVERTED FROM PYTHON VERSION
4 REM =====================================
10 REM
100 REM MAIN PROGRAM
110 rem PRINT "THE COMPUTER LANGUAGE BENCHMARKS GAME"
120 rem PRINT "SPECTRAL-NORM"
130 rem PRINT
140 N% = 200
150 rem PRINT "MATRIX SIZE: "; N%
160 REM
200 REM ALLOCATE ARRAYS
210 DIM U(N%)
220 DIM V(N%)
230 DIM TMP(N%)
235 DIM TRIANGLE(N% * 2)
240 REM
250 REM PRECOMPUTE TRIANGLE NUMBERS (optimization: eliminate repeated calculation)
260 FOR K% = 0 TO N% * 2
270 TRIANGLE(K%) = K% * (K% + 1) / 2
280 NEXT K%
290 REM
300 REM INITIALIZE U VECTOR TO 1
310 FOR I% = 0 TO N% - 1
320 U(I%) = 1
330 NEXT I%
340 REM
400 REM POWER ITERATION (10 TIMES)
410 FOR ITER% = 1 TO 10
420 GOSUB 2000
430 GOSUB 3000
440 NEXT ITER%
450 REM
500 REM CALCULATE RESULT
510 VBV = 0
520 VV = 0
530 FOR I% = 0 TO N% - 1
540 VBV = VBV + U(I%) * V(I%)
550 VV = VV + V(I%) * V(I%)
560 NEXT I%
570 RESULT = SQR(VBV / VV)
580 REM
600 REM OUTPUT RESULT
610 rem PRINT "SPECTRAL NORM: "; RESULT
620 PRINT RESULT
630 END
640 REM
2000 REM SUBROUTINE: MULTIPLY AtAv (U -> TMP -> V)
2010 REM STEP 1: MULTIPLY Av (U -> TMP)
2020 FOR I% = 0 TO N% - 1
2025 I_PLUS_1 = I% + 1
2030 SUM = 0
2040 FOR J% = 0 TO N% - 1
2050 IJ% = I% + J%
2060 DENOM = TRIANGLE(IJ%) + I_PLUS_1
2070 SUM = SUM + U(J%) / DENOM
2080 NEXT J%
2090 TMP(I%) = SUM
2100 NEXT I%
2110 REM STEP 2: MULTIPLY Atv (TMP -> V)
2120 FOR I% = 0 TO N% - 1
2130 SUM = 0
2140 FOR J% = 0 TO N% - 1
2145 J_PLUS_1 = J% + 1
2150 IJ% = I% + J%
2160 DENOM = TRIANGLE(IJ%) + J_PLUS_1
2170 SUM = SUM + TMP(J%) / DENOM
2180 NEXT J%
2190 V(I%) = SUM
2200 NEXT I%
2210 RETURN
2220 REM
3000 REM SUBROUTINE: MULTIPLY AtAv (V -> TMP -> U)
3010 REM STEP 1: MULTIPLY Av (V -> TMP)
3020 FOR I% = 0 TO N% - 1
3025 I_PLUS_1 = I% + 1
3030 SUM = 0
3040 FOR J% = 0 TO N% - 1
3050 IJ% = I% + J%
3060 DENOM = TRIANGLE(IJ%) + I_PLUS_1
3070 SUM = SUM + V(J%) / DENOM
3080 NEXT J%
3090 TMP(I%) = SUM
3100 NEXT I%
3110 REM STEP 2: MULTIPLY Atv (TMP -> U)
3120 FOR I% = 0 TO N% - 1
3130 SUM = 0
3140 FOR J% = 0 TO N% - 1
3145 J_PLUS_1 = J% + 1
3150 IJ% = I% + J%
3160 DENOM = TRIANGLE(IJ%) + J_PLUS_1
3170 SUM = SUM + TMP(J%) / DENOM
3180 NEXT J%
3190 U(I%) = SUM
3200 NEXT I%
3210 RETURN
